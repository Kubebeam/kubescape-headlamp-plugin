// https://github.com/kubescape/storage/tree/main/pkg/apis/softwarecomposition
// Only fields as used in this project are declared

import { Metadata } from './Metadata';

export interface OpenVulnerabilityExchangeContainer {
  metadata: Metadata;
  spec: {
    '@context': string;
    '@id': string;
    author: string;
    last_updated: string;
    role: string;
    supplier: string;
    timestamp: string;
    tooling: string;
    version: number;
    statements: OpenVulnerabilityExchangeContainer.Statement[];
  };
}

export namespace OpenVulnerabilityExchangeContainer {
  export interface Statement {
    '@id': string;
    action_statement: string;
    action_statement_timestamp: string;
    impact_statement: string;
    justification: string;
    last_updated: string;
    products: Product[];
    status: AffectedStatus;
    vulnerability: VexVulnerability;
  }

  export interface Product {
    '@id': string;
    subcomponents: {
      '@id': string;
    }[];
  }

  export enum AffectedStatus {
    Affected = 'affected',
    NotAffected = 'not_affected',
  }

  export interface VexVulnerability {
    '@id': string;
    aliases: string[];
    description: string;
    name: string;
  }
}
