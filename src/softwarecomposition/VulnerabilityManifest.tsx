// https://github.com/kubescape/storage/tree/main/pkg/apis/softwarecomposition
// Only fields as used in this project are declared

export interface VulnerabilityManifest {
  metadata: {
    creationTimestamp: string;
    name: string;
    annotations: VulnerabilityManifest.StringDict;
  };
  spec: {
    payload: {
      matches: VulnerabilityManifest.Match[];
      source: {
        type: string;
      };
    };
  };
}

export namespace VulnerabilityManifest {
  export interface Artifact {
    name: string;
    version: string;
  }

  export interface Vulnerability {
    cvss: {
      metrics: {
        baseScore: number;
      };
    }[];
    dataSource: string;
    description: string;
    fix: {
      state: string;
      versions: string[];
    };
    id: string;
    severity: string;
  }

  export interface Match {
    artifact: Artifact;
    relatedVulnerabilities: {
      id: string;
      description: string;
    }[];
    vulnerability: Vulnerability;
  }

  export interface StringDict {
    [key: string]: string;
  }
}
